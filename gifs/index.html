<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>GIFs — Michael Mace</title>
    <link rel="stylesheet" href="../style.css" />
    <link rel="icon" href="/favicon.png" />
    <meta name="color-scheme" content="light dark" />
  </head>

  <body>
    <p class="nav-links">
      <a href="../index.html">Home</a> ·
      <a href="../notes/index.html">Notes</a> · <a href="index.html">GIFs</a> ·
      <a
        href="https://github.com/mmbmf1"
        target="_blank"
        rel="noopener noreferrer"
        >GitHub</a
      >
    </p>

    <h1 class="no-margin-bottom">GIFs <span id="gif-editor-wrap" class="hidden"><a id="gif-editor-link" href="/editor/gifs.html" class="local-edit" aria-label="Edit GIFs" title="Edit GIFs">&#9998;</a></span></h1>

    <div class="gif-rows">
      <div id="gif-favorites-wrap">
        <p class="gif-row-label">favorites</p>
        <div
          id="gif-row-favorites"
          class="gif-grid"
          role="region"
          aria-label="Favorite GIFs"
        ></div>
      </div>
      <div id="gif-others-wrap">
        <p class="gif-row-label">these are good too</p>
        <div
          id="gif-row-others"
          class="gif-grid"
          role="region"
          aria-label="GIF carousel"
        >
          <div class="gif-card">
            <img
              class="gif"
              data-gif="https://media2.giphy.com/media/v1.Y2lkPTc5MGI3NjExYjV2bjh4bDIybml4cmJ5MTV4dzl5M2J0eWt3NWpqbTc4Yng0ODQ4bSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/kUgUnmqig0X3q/giphy.gif"
              src="https://media2.giphy.com/media/v1.Y2lkPTc5MGI3NjExYjV2bjh4bDIybml4cmJ5MTV4dzl5M2J0eWt3NWpqbTc4Yng0ODQ4bSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/kUgUnmqig0X3q/giphy.gif"
              alt="les grossman"
              data-title="if you dont like les grossman, then fuck you"
              loading="lazy"
            />
            <div class="card-labels">
              <span class="card-label">click to copy</span>
              <span class="card-label card-label-title"></span>
            </div>
          </div>

          <div class="gif-card">
            <img
              class="gif"
              data-gif="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExdzV3cjF5Y2pibmpiaGl0ejNtZTJzdG1waTJiaHk4YWdkbzJpZWNpaiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/qOhzfrkMzQO8U/giphy.gif"
              src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExdzV3cjF5Y2pibmpiaGl0ejNtZTJzdG1waTJiaHk4YWdkbzJpZWNpaiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/qOhzfrkMzQO8U/giphy.gif"
              alt="the future is bright"
              data-title="the future is bright"
              loading="lazy"
            />
            <div class="card-labels">
              <span class="card-label">click to copy</span>
              <span class="card-label card-label-title"></span>
            </div>
          </div>

          <div class="gif-card">
            <img
              class="gif"
              data-gif="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExamZsdWRxbDJlbXFmYTBpeDI5MmliNmMwbGhvYTRrcXRzN3c2dm4wZyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/E87jjnSCANThe/giphy.gif"
              src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExamZsdWRxbDJlbXFmYTBpeDI5MmliNmMwbGhvYTRrcXRzN3c2dm4wZyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/E87jjnSCANThe/giphy.gif"
              alt="gathering requirements"
              data-title="fucking tell me already, have shit todo"
              loading="lazy"
            />
            <div class="card-labels">
              <span class="card-label">click to copy</span>
              <span class="card-label card-label-title"></span>
            </div>
          </div>

          <div class="gif-card">
            <img
              class="gif"
              data-gif="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExYmw2Z2c0YWN0MHJ4OGVnb2Y5NnV0bHJ0Y2wyY25oZnJtbnQzMDVpbSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/dIV7HapCtAzHE6N3j1/giphy.gif"
              src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExYmw2Z2c0YWN0MHJ4OGVnb2Y5NnV0bHJ0Y2wyY25oZnJtbnQzMDVpbSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/dIV7HapCtAzHE6N3j1/giphy.gif"
              alt="patriotic"
              data-title="you wish you were this badass"
              loading="lazy"
            />
            <div class="card-labels">
              <span class="card-label">click to copy</span>
              <span class="card-label card-label-title"></span>
            </div>
          </div>

          <div class="gif-card">
            <img
              class="gif"
              data-gif="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExOXNsajA5bHNrZXIxdDl0aGtwbWVlYWdjeHk2OW91bGZkbHRzdW91YSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/MM0Jrc8BHKx3y/giphy.gif"
              src="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExOXNsajA5bHNrZXIxdDl0aGtwbWVlYWdjeHk2OW91bGZkbHRzdW91YSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/MM0Jrc8BHKx3y/giphy.gif"
              alt="legend"
              data-title=""
              loading="lazy"
            />
            <div class="card-labels">
              <span class="card-label">click to copy</span>
              <a
                class="card-label"
                href="https://www.youtube.com/watch?v=bS5P_LAqiVg&t=64s&pp=ygUJa3VuZyBmdXJ5"
                target="_blank"
                rel="noopener"
                title="open on YouTube"
              >
                view on youtube
              </a>
              <span class="card-label card-label-title"></span>
            </div>
          </div>

          <div class="gif-card">
            <img
              class="gif"
              data-gif="https://media0.giphy.com/media/v1.Y2lkPTc5MGI3NjExdWFpenZpNXozZmlzc3ZweHBsaDVkajAzNHdxOHRwYjVhaWJweTBibSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/jUwpNzg9IcyrK/giphy.gif"
              src="https://media0.giphy.com/media/v1.Y2lkPTc5MGI3NjExdWFpenZpNXozZmlzc3ZweHBsaDVkajAzNHdxOHRwYjVhaWJweTBibSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/jUwpNzg9IcyrK/giphy.gif"
              alt="my bad"
              data-title="my bad..."
              loading="lazy"
            />
            <div class="card-labels">
              <span class="card-label">click to copy</span>
              <span class="card-label card-label-title"></span>
            </div>
          </div>

          <div class="gif-card">
            <img
              class="gif"
              data-gif="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExZXdhbWk3MzI4ZTNrcTRld2JyM3p3amhnMjlvZWR6NTI5MWRlcW1oYyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/wi8Ez1mwRcKGI/giphy.gif"
              src="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExZXdhbWk3MzI4ZTNrcTRld2JyM3p3amhnMjlvZWR6NTI5MWRlcW1oYyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/wi8Ez1mwRcKGI/giphy.gif"
              alt="do it"
              data-title="hurry up and do it"
              loading="lazy"
            />
            <div class="card-labels">
              <span class="card-label">click to copy</span>
              <span class="card-label card-label-title"></span>
            </div>
          </div>

          <div class="gif-card">
            <img
              class="gif"
              data-gif="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExeTgzNzV3d2ZveWNqYmo2Nnl4YThjZ2ptbmxrcnNtazhjYjl0MWl6OCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/oxahPI4vpzbSE/giphy.gif"
              src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExeTgzNzV3d2ZveWNqYmo2Nnl4YThjZ2ptbmxrcnNtazhjYjl0MWl6OCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/oxahPI4vpzbSE/giphy.gif"
              alt="for sure"
              data-title="yup no worries"
              loading="lazy"
            />
            <div class="card-labels">
              <span class="card-label">click to copy</span>
              <span class="card-label card-label-title"></span>
            </div>
          </div>

          <div class="gif-card">
            <img
              class="gif"
              src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExeDE2M21ic3F2ZzBhdTAwb25mbWJiMm9uODV1MXNyOGY1emd5b2RzeSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/VGJPsBvlsHDyw/giphy.gif"
              data-gif="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExeDE2M21ic3F2ZzBhdTAwb25mbWJiMm9uODV1MXNyOGY1emd5b2RzeSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/VGJPsBvlsHDyw/giphy.gif"
              alt="heck ya"
              data-title="heck ya"
              loading="lazy"
            />
            <div class="card-labels">
              <span class="card-label">click to copy</span>
              <span class="card-label card-label-title"></span>
            </div>
          </div>

          <div class="gif-card">
            <img
              class="gif"
              data-gif="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExNWlwbWI2NHhoeXZwaWFnZ243eG41ajZtZnF3bWcyNmRxaWxsemVzeiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/Ph0izSl5UidtS/giphy.gif"
              src="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExNWlwbWI2NHhoeXZwaWFnZ243eG41ajZtZnF3bWcyNmRxaWxsemVzeiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/Ph0izSl5UidtS/giphy.gif"
              alt="cousin randy"
              data-title="cousin randy"
              loading="lazy"
            />
            <div class="card-labels">
              <span class="card-label">click to copy</span>
              <span class="card-label card-label-title"></span>
            </div>
          </div>

          <div class="gif-card">
            <img
              class="gif"
              data-gif="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExM211bHVpcTl0cGJmeHprdDV2YTM4Y2FyZGFhbzVjcGRqbzQ0ZHA5MiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/0MHgWp8xxjdd0TW0n6/giphy.gif"
              src="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExM211bHVpcTl0cGJmeHprdDV2YTM4Y2FyZGFhbzVjcGRqbzQ0ZHA5MiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/0MHgWp8xxjdd0TW0n6/giphy.gif"
              alt="nice work"
              data-title="nice work"
              loading="lazy"
            />
            <div class="card-labels">
              <span class="card-label">click to copy</span>
              <span class="card-label card-label-title"></span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="toast" class="toast" role="status" aria-live="polite">copied</div>

    <script>
      const toast = document.getElementById('toast')
      let toastTimer = null

      const FAVORITES_KEY = 'gif-favorites'
      const MAX_FAVORITES = 10
      const isLocal =
        /^localhost$|^127\.0\.0\.1$/.test(location.hostname) ||
        location.hostname === ''
      const EDITOR_PORT = 3002
      const editorOrigin =
        isLocal && String(location.port) !== String(EDITOR_PORT)
          ? location.protocol + '//' + location.hostname + ':' + EDITOR_PORT
          : ''

      const PUBLIC_FAVORITES = [
        'https://media2.giphy.com/media/v1.Y2lkPTc5MGI3NjExYjV2bjh4bDIybml4cmJ5MTV4dzl5M2J0eWt3NWpqbTc4Yng0ODQ4bSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/kUgUnmqig0X3q/giphy.gif',
        'https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExamZsdWRxbDJlbXFmYTBpeDI5MmliNmMwbGhvYTRrcXRzN3c2dm4wZyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/E87jjnSCANThe/giphy.gif',
        'https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExYmw2Z2c0YWN0MHJ4OGVnb2Y5NnV0bHJ0Y2wyY25oZnJtbnQzMDVpbSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/dIV7HapCtAzHE6N3j1/giphy.gif',
      ]

      function getFavorites() {
        if (!isLocal) return PUBLIC_FAVORITES.slice(0, MAX_FAVORITES)
        try {
          const raw = localStorage.getItem(FAVORITES_KEY)
          const arr = raw ? JSON.parse(raw) : []
          return Array.isArray(arr) ? arr.slice(0, MAX_FAVORITES) : []
        } catch {
          return []
        }
      }
      async function syncFromApi() {
        if (!isLocal) return false
        const base = editorOrigin || ''
        try {
          const res = await fetch(base + '/api/gifs/data')
          if (!res.ok) return false
          const data = await res.json()
          if (Array.isArray(data.items)) {
            renderRowsFromEditorData(data.items)
            return true
          }
        } catch (_) {}
        try {
          const res = await fetch(base + '/api/gifs/favorites')
          if (!res.ok) return false
          const data = await res.json()
          const arr = (data.favorites || data) || []
          if (Array.isArray(arr) && arr.length > 0) {
            const list = arr.filter((u) => typeof u === 'string').slice(0, MAX_FAVORITES)
            setFavorites(list)
          }
        } catch (_) {}
        return false
      }
      function setFavorites(arr) {
        if (!isLocal) return
        localStorage.setItem(
          FAVORITES_KEY,
          JSON.stringify(arr.slice(0, MAX_FAVORITES))
        )
      }

      function getGifId(card) {
        const img = card.querySelector('.gif')
        return img && img.getAttribute('data-gif')
      }

      function createCardForUrl(url, title, alt) {
        const card = document.createElement('div')
        card.className = 'gif-card'
        const img = document.createElement('img')
        img.className = 'gif'
        img.src = url
        img.setAttribute('data-gif', url)
        img.alt = alt || ''
        img.loading = 'lazy'
        if (title) img.setAttribute('data-title', title)
        const labels = document.createElement('div')
        labels.className = 'card-labels'
        labels.innerHTML = '<span class="card-label">click to copy</span><span class="card-label card-label-title"></span>'
        card.appendChild(img)
        card.appendChild(labels)
        return card
      }

      function createCardFromItem(item) {
        return createCardForUrl(item.url, item.title, item.alt)
      }

      function renderRowsFromEditorData(items) {
        const rowFav = document.getElementById('gif-row-favorites')
        const rowOthers = document.getElementById('gif-row-others')
        const wrap = document.getElementById('gif-favorites-wrap')
        if (!rowFav || !rowOthers) return
        const favorites = items.filter((i) => i.favorite).slice(0, MAX_FAVORITES)
        const others = items.filter((i) => !i.favorite)
        rowFav.innerHTML = ''
        rowOthers.innerHTML = ''
        favorites.forEach((item) => rowFav.appendChild(createCardFromItem(item)))
        others.forEach((item) => rowOthers.appendChild(createCardFromItem(item)))
        if (wrap) wrap.style.display = rowFav.children.length ? '' : 'none'
        fillTitlePills()
        attachCopyHandlers()
      }

      function fillTitlePills() {
        document.querySelectorAll('.gif-card').forEach((card) => {
          const img = card.querySelector('.gif')
          const titleEl = card.querySelector('.card-label-title')
          const title = img && img.getAttribute('data-title')
          if (img && titleEl && title) titleEl.textContent = title
        })
      }

      function renderRows() {
        const rowFav = document.getElementById('gif-row-favorites')
        const rowOthers = document.getElementById('gif-row-others')
        if (!rowFav || !rowOthers) return
        const favorites = getFavorites().slice(0, MAX_FAVORITES)
        const cards = [].slice
          .call(rowFav.querySelectorAll('.gif-card'))
          .concat([].slice.call(rowOthers.querySelectorAll('.gif-card')))
        const byId = new Map(cards.map((c) => [getGifId(c), c]))
        const rest = cards.filter((c) => !favorites.includes(getGifId(c)))
        rowFav.innerHTML = ''
        rowOthers.innerHTML = ''
        favorites.forEach((id) => {
          const card = byId.get(id)
          if (card) {
            rowFav.appendChild(card)
          } else {
            rowFav.appendChild(createCardForUrl(id, '', ''))
          }
        })
        rest.forEach((c) => rowOthers.appendChild(c))
        const wrap = document.getElementById('gif-favorites-wrap')
        if (wrap) wrap.style.display = rowFav.children.length ? '' : 'none'
        fillTitlePills()
        attachCopyHandlers()
      }

      function attachCopyHandlers() {
        document.querySelectorAll('img[data-gif]').forEach((img) => {
          img.onclick = async (e) => {
            e.preventDefault()
            e.stopPropagation()
            const url = img.getAttribute('data-gif')
            const md = `![](${url})`
            try {
              await copyText(md)
              showToast('copied markdown')
            } catch {
              showToast('copy failed')
            }
          }
        })
      }

      function showToast(text = 'copied') {
        toast.textContent = text
        toast.classList.add('show')
        clearTimeout(toastTimer)
        toastTimer = setTimeout(() => toast.classList.remove('show'), 900)
      }

      async function copyText(text) {
        if (navigator.clipboard && window.isSecureContext) {
          await navigator.clipboard.writeText(text)
          return
        }
        const ta = document.createElement('textarea')
        ta.value = text
        ta.style.position = 'fixed'
        ta.style.left = '-9999px'
        document.body.appendChild(ta)
        ta.select()
        document.execCommand('copy')
        ta.remove()
      }

      ;(async function init() {
        const usedEditorData = await syncFromApi()
        if (!usedEditorData) renderRows()
        if (isLocal) {
          const wrap = document.getElementById('gif-editor-wrap')
          if (wrap) wrap.classList.remove('hidden')
          const link = document.getElementById('gif-editor-link')
          if (link && editorOrigin) link.href = editorOrigin + '/editor/gifs.html'
        }
      })()
    </script>
  </body>
</html>
